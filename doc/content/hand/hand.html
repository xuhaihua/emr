<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="../../css/style.css">
        <script src="../../js/lib/flexible.js"></script>
        <title>
            EMR文档
        </title>
        <script>
            function toLink(link, linkStorage) {
                localStorage.setItem("currentChild", linkStorage);
                event.stopPropagation();
                window.location.href = link;
            }
        </script>
    </head>
    <body style="overflow-y: scroll;height: 100%;">
        <div class="content-right-frame">
            <div class="h-30"></div>

            <!--概述-->
            <div>
                <h1>
                    Hand (手) 模块
                </h1>
                <p class="fs-16">
                    在EMR.Space类中定义了两个静态属性leftHand、rightHand分别代表左手和右手
                </p>
                <div style="display: flex; justify-content: center; border: 1px solid #dbdbdb;">
                    <img style="width: 45%;" src="../../img/ex28.png" alt="" />
                </div>
            </div>
            
            <h3 class="mt-30">
                <ul class="ml-25">
                    <li>Hand中各手指关节对应的属性列表</li>
                </ul>
            </h3>

            <div class="table-border">
                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>拇指</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>

                    <tr>
                        <td class="font-bold">ThumbTip</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">ThumbDistalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">ThumbProximalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">ThumbMetacarpalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>

                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>食指</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>

                    <tr>
                        <td class="font-bold">IndexTip</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">IndexDistalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">IndexMiddleJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">IndexKnuckle</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>

                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>中指</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>

                    <tr>
                        <td class="font-bold">MiddleTip</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">MiddleDistalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">MiddleMiddleJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">MiddleKnuckle</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">MiddleMetacarpal</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>

                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>无名指</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>

                    <tr>
                        <td class="font-bold">RingTip</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">RingDistalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">RingMiddleJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">RingKnuckle</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>

                    <tr>
                        <td class="font-bold">RingMetacarpal</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>

                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>小指</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">PinkyTip</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">PinkyDistalJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">PinkyMiddleJoint</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">PinkyKnuckle</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">PinkyMetacarpal</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>

                <div class="table-subTitle">
                    <div>
                        <span></span>
                        <label>其他</label>
                    </div>
                </div>
                <table cellspacing="0" class="table bb-1 bt-1">
                    <tr class="tableHead">
                        <td>名称</td>
                        <td>数据类型</td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">Palm (掌心)</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
    
                    <tr>
                        <td class="font-bold">Wrist（腕关节）</td>
                        <td><span class="font-bold link" onclick="toLink('./struct/MixedRealityPose.html', './content/hand/struct/MixedRealityPose.html')">MixedRealityPose</span></td>
                    </tr>
                </table>
            </div>

            <h3 class="mt-30">
                <ul class="ml-25">
                    <li>事件</li>
                </ul>
            </h3>

            <table cellspacing="0" class="table bb-1 bt-1">
                <tr class="tableHead">
                    <td style="width:20%">名称</td>
                    <td style="width:40%">事件委托</td>
                    <td>说明</td>
                </tr>
                <tr>
                    <td class="font-bold" style="width: 15%;">onHandPoseChange</td>
                    <td>UnityEngine.Events.UnityAction&lt;<span class="link" onclick="toLink('./struct/HandPoseChangeEventData.html', './content/hand/struct/HandPoseChangeEventData.html')">HandPoseChangeEventData</span>></td>
                    <td>手的位姿改变事件</td>
                </tr>
            </table>
            
            <h3 class="mt-30">
                Example：
            </h3>
            <p class="fs-16">
                以下代码通过Hand的手指属性检查手掌是否正对摄像头且拇指与食指不处于黏合状态
            </p>

            <h4 style="border-left:4px solid #999; padding-left: .1852rem; margin-top: .2778rem;">
                主视图代码：
            </h4>

            <code>
                <pre style="margin: 0px; padding: 0px;" >
<span>&lt;</span><label>Root</label><span>&gt;</span>
    <span>&lt;</span><label>PanelRoot<span> id="infoLabel" x="0" y="0" z="300" width="300" height="100" /<span>&gt;</span>
<span>&lt;</span><span style="color:#F07178;">/Root</span><span>&gt;</span>
</pre>
            </code>

            <h4 style="border-left:4px solid #999; padding-left: .1852rem; margin-top: .2778rem;">
                代码逻辑：
            </h4>
            <code>
                <pre style="margin: 0px; padding: 0px;">
<span class="tag">private float</span> flatHandThreshold = 45.0f;

<span class="commentary">// 手掌向上的法线与摄像头前向射线之间的夹角</span>
<span class="tag">private float</span> facingCameraTrackingThreshold = 80.0f;

<span class="commentary">// 是否要求手指打开</span>
<span class="tag">private bool</span> requireFlatHand = <span class="tag">true</span>;

<span class="commentary">// 定义手势</span>
<span class="tag">private</span> <span class="adorn">bool</span> <span class="methodName">gesture</span><span class="block">()</span>
<span class="block">{</span>
    <span class="tag">var</span> hand = EMR.<span class="genericity">Space</span>.rightHand;
    <span class="genericity">MixedRealityPose</span> <span class="adorn">palmPose</span> = <span class="adorn">hand</span>.Palm;
    <span class="return">if</span> (requireFlatHand)
    {
        <span class="commentary">// 获取拇指与食指的位姿</span>
        <span class="tag">var</span> <span class="adorn">ThumbTip</span> = <span class="adorn">hand</span>.ThumbTip;
        <span class="tag">var</span> <span class="adorn">IndexTip</span> = <span class="adorn">hand</span>.IndexTip;

        <span class="tag">var</span> <span class="adorn">handNormal</span> = <span class="genericity">Vector3</span>.<span class="methodName">Cross</span>(<span class="adorn">ThumbTip</span>.Position - <span class="adorn">palmPose</span>.Position, <span class="adorn">IndexTip</span>.Position - <span class="adorn">ThumbTip</span>.Position).normalized;

        <span class="return">if</span> (<span class="genericity">Vector3</span>.<span class="methodName">Angle</span>(<span class="adorn">palmPose</span>.Up, <span class="adorn">handNormal</span>) > flatHandThreshold)
        {
            <span class="return">return</span> <span class="tag">false</span>;
        }
    }

    <span class="return">if</span> (<span class="adorn">palmPose</span> != <span class="tag">null</span>)
    {
        <span class="tag">float</span> <span class="adorn">palmCameraAngle</span> = <span class="genericity">Vector3</span>.<span class="methodName">Angle</span>(<span class="adorn">palmPose</span>.Up, <span class="adorn">CameraCache</span>.Main.transform.forward);
        <span class="return">return</span> palmCameraAngle &lt; facingCameraTrackingThreshold;
    }

    <span class="return">return</span> <span class="tag">false;</span>
<span class="block">}</span>

<span class="commentary">// mounted生命周期函数，在这里文档内容已绑定给视图，内容的样式、布局都已完成设置</span>
<span class="tag">protected</span> <span class="tag">override</span> <span class="adorn">void</span> <span class="methodName">mounted</span><span class="block">(</span>)</span>
<span class="block">{</span>
    <span class="commentary">// 注册手的位姿改变事件</span>
    EMR.<span class="genericity">Space</span>.rightHand.onHandPoseChange.<span class="methodName">AddListener</span>((<span class="genericity">HandPoseChangeEventData</span> eventData) =>
    {
        <span class="commentary">// 获取信息显示Label</span>
        <span class="tag">var</span> <span class="adorn">infoLabel</span> = <span class="tag">this</span>.<span class="methodName">getNodeById</span>&lt;<span class="genericity">PanelRoot</span>>(<span class="str">"infoLabel"</span>);

        <span class="commentary">// 当检测到定义的手势时在infoLabel上输出gesture detected</span>
        <span class="return">if</span> (<span class="methodName">gesture</span>())
        {
            <span class="adorn">infoLabel</span>.text = <span class="str">"gesture detected"</span>;
        } else
        {
            <span class="adorn">infoLabel</span>.text = <span class="str">"gesture not detected"</span>;
        }
    });
<span class="block">}</span>
</pre>
            </code>

            <div class="result mt-30 v4">
                <div>
                    <video src="../../img/v8.mp4" muted="muted" autoplay="autoplay" loop></video>
                </div>
            </div>

            <div class="tip custom-block">
                <p class="custom-block-title pd-0 color-black font-bold mt-0">
                    <span class="infoTitle">
                        <span>
                            <img src="../../img/info.png" alt="" />
                        </span>
                        <label>小结：</label>
                    </span>
                </p>
                <p>
                    使用上述这些属性可以很方便的创建自定义手势；手势的创建一般有两种方式，一种是跟踪各个关节的位姿数据通过空间运算来判断用户是否做出某种手势。另一种是在特定的关节处插入节点通过节点的碰撞测试来判断用户手势。
                </p>
            </div>
        <div class="h-30"></div>
    </body>
</html>